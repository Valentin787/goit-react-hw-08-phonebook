{"ast":null,"code":"import { createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\naxios.defaults.baseURL = \"https://connections-api.herokuapp.com\";\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n\n  unset() {\n    axios.defaults.headers.common.Authorization = '';\n  }\n\n};\nconst register = createAsyncThunk('auth/register', async (credentials, _ref) => {\n  let {\n    rejectWithValue\n  } = _ref;\n\n  try {\n    const {\n      data\n    } = await axios.post('/users/signup', credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {\n    return rejectWithValue();\n  }\n});\nconst logIn = createAsyncThunk('auth/logIn', async (credentials, _ref2) => {\n  let {\n    rejectWithValue\n  } = _ref2;\n\n  try {\n    const {\n      data\n    } = await axios.post('/users/login', credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {\n    return rejectWithValue();\n  }\n});\nconst logOut = createAsyncThunk('auth/logout', async (_, _ref3) => {\n  let {\n    rejectWithValue\n  } = _ref3;\n\n  try {\n    await axios.post('/users/logout');\n    token.unset();\n  } catch (error) {\n    return rejectWithValue();\n  }\n});\nconst fetchUser = createAsyncThunk('auth/fetchUser', async (_, _ref4) => {\n  let {\n    getState,\n    rejectWithValue\n  } = _ref4;\n  const state = getState();\n  const persistedToken = state.auth.token;\n  if (!persistedToken) return rejectWithValue();\n  token.set(persistedToken);\n\n  try {\n    const {\n      data\n    } = await axios.get('/users/current');\n    return data;\n  } catch (error) {\n    return rejectWithValue();\n  }\n});\nexport { register, logIn, logOut, fetchUser, token };","map":{"version":3,"names":["createAsyncThunk","axios","defaults","baseURL","token","set","headers","common","Authorization","unset","register","credentials","rejectWithValue","data","post","error","logIn","logOut","_","fetchUser","getState","state","persistedToken","auth","get"],"sources":["/Users/valentinkuzmich/Desktop/projects Go IT/goit-react-hw-08-phonebook/src/redux/auth/authOperations.js"],"sourcesContent":["import { createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios  from \"axios\";\n\naxios.defaults.baseURL = \"https://connections-api.herokuapp.com\";\n\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = ''\n  }\n};\n\nconst register = createAsyncThunk('auth/register', async (credentials,{rejectWithValue}) => {\n  try {\n    const { data } = await axios.post('/users/signup', credentials)\n    token.set(data.token)\n    return data\n  } catch (error) {\n    return rejectWithValue()\n  }\n})\n\nconst logIn = createAsyncThunk('auth/logIn', async (credentials,{rejectWithValue}) => {\n  try {\n    const { data } = await axios.post('/users/login', credentials)\n    token.set(data.token)\n    return data\n  } catch (error) {\n      return rejectWithValue()\n  }\n});\n\nconst logOut = createAsyncThunk('auth/logout', async (_,{rejectWithValue}) => {\n  try {\n    await axios.post('/users/logout')\n    token.unset()\n  } catch (error) {\n    return rejectWithValue()\n  }\n});\n\nconst fetchUser = createAsyncThunk('auth/fetchUser', async(_, { getState, rejectWithValue}) => {\n  const state = getState();\n  const persistedToken = state.auth.token;\n  if (!persistedToken) return rejectWithValue();\n\n  token.set(persistedToken)\n  \n  try {\n    const { data } = await axios.get('/users/current');\n    return data;\n  } catch (error) {\n    return rejectWithValue()\n  }\n});\n\nexport { register, logIn, logOut, fetchUser,token };\n"],"mappings":"AAAA,SAASA,gBAAT,QAAiC,kBAAjC;AACA,OAAOC,KAAP,MAAmB,OAAnB;AAEAA,KAAK,CAACC,QAAN,CAAeC,OAAf,GAAyB,uCAAzB;AAEA,MAAMC,KAAK,GAAG;EACZC,GAAG,CAACD,KAAD,EAAQ;IACTH,KAAK,CAACC,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,GAA+C,UAASJ,KAAM,EAA9D;EACD,CAHW;;EAIZK,KAAK,GAAG;IACNR,KAAK,CAACC,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,GAA8C,EAA9C;EACD;;AANW,CAAd;AASA,MAAME,QAAQ,GAAGV,gBAAgB,CAAC,eAAD,EAAkB,OAAOW,WAAP,WAAyC;EAAA,IAAtB;IAACC;EAAD,CAAsB;;EAC1F,IAAI;IACF,MAAM;MAAEC;IAAF,IAAW,MAAMZ,KAAK,CAACa,IAAN,CAAW,eAAX,EAA4BH,WAA5B,CAAvB;IACAP,KAAK,CAACC,GAAN,CAAUQ,IAAI,CAACT,KAAf;IACA,OAAOS,IAAP;EACD,CAJD,CAIE,OAAOE,KAAP,EAAc;IACd,OAAOH,eAAe,EAAtB;EACD;AACF,CARgC,CAAjC;AAUA,MAAMI,KAAK,GAAGhB,gBAAgB,CAAC,YAAD,EAAe,OAAOW,WAAP,YAAyC;EAAA,IAAtB;IAACC;EAAD,CAAsB;;EACpF,IAAI;IACF,MAAM;MAAEC;IAAF,IAAW,MAAMZ,KAAK,CAACa,IAAN,CAAW,cAAX,EAA2BH,WAA3B,CAAvB;IACAP,KAAK,CAACC,GAAN,CAAUQ,IAAI,CAACT,KAAf;IACA,OAAOS,IAAP;EACD,CAJD,CAIE,OAAOE,KAAP,EAAc;IACZ,OAAOH,eAAe,EAAtB;EACH;AACF,CAR6B,CAA9B;AAUA,MAAMK,MAAM,GAAGjB,gBAAgB,CAAC,aAAD,EAAgB,OAAOkB,CAAP,YAA+B;EAAA,IAAtB;IAACN;EAAD,CAAsB;;EAC5E,IAAI;IACF,MAAMX,KAAK,CAACa,IAAN,CAAW,eAAX,CAAN;IACAV,KAAK,CAACK,KAAN;EACD,CAHD,CAGE,OAAOM,KAAP,EAAc;IACd,OAAOH,eAAe,EAAtB;EACD;AACF,CAP8B,CAA/B;AASA,MAAMO,SAAS,GAAGnB,gBAAgB,CAAC,gBAAD,EAAmB,OAAMkB,CAAN,YAA0C;EAAA,IAAjC;IAAEE,QAAF;IAAYR;EAAZ,CAAiC;EAC7F,MAAMS,KAAK,GAAGD,QAAQ,EAAtB;EACA,MAAME,cAAc,GAAGD,KAAK,CAACE,IAAN,CAAWnB,KAAlC;EACA,IAAI,CAACkB,cAAL,EAAqB,OAAOV,eAAe,EAAtB;EAErBR,KAAK,CAACC,GAAN,CAAUiB,cAAV;;EAEA,IAAI;IACF,MAAM;MAAET;IAAF,IAAW,MAAMZ,KAAK,CAACuB,GAAN,CAAU,gBAAV,CAAvB;IACA,OAAOX,IAAP;EACD,CAHD,CAGE,OAAOE,KAAP,EAAc;IACd,OAAOH,eAAe,EAAtB;EACD;AACF,CAbiC,CAAlC;AAeA,SAASF,QAAT,EAAmBM,KAAnB,EAA0BC,MAA1B,EAAkCE,SAAlC,EAA4Cf,KAA5C"},"metadata":{},"sourceType":"module"}