{"ast":null,"code":"import _regeneratorRuntime from\"/Users/valentinkuzmich/Desktop/projects Go IT/goit-react-hw-08-phonebook/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/valentinkuzmich/Desktop/projects Go IT/goit-react-hw-08-phonebook/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createAsyncThunk}from\"@reduxjs/toolkit\";import axios from\"axios\";axios.defaults.baseURL=\"https://connections-api.herokuapp.com\";var token={set:function set(token){axios.defaults.headers.common.Authorization=\"Bearer \".concat(token);},unset:function unset(){axios.defaults.headers.common.Authorization='';}};var register=createAsyncThunk('auth/register',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(credentials,_ref){var rejectWithValue,_yield$axios$post,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:rejectWithValue=_ref.rejectWithValue;_context.prev=1;_context.next=4;return axios.post('/users/signup',credentials);case 4:_yield$axios$post=_context.sent;data=_yield$axios$post.data;token.set(data.token);return _context.abrupt(\"return\",data);case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);return _context.abrupt(\"return\",rejectWithValue());case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}());var logIn=createAsyncThunk('auth/logIn',/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(credentials,_ref3){var rejectWithValue,_yield$axios$post2,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:rejectWithValue=_ref3.rejectWithValue;_context2.prev=1;_context2.next=4;return axios.post('/users/login',credentials);case 4:_yield$axios$post2=_context2.sent;data=_yield$axios$post2.data;token.set(data.token);return _context2.abrupt(\"return\",data);case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);return _context2.abrupt(\"return\",rejectWithValue());case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[1,10]]);}));return function(_x3,_x4){return _ref4.apply(this,arguments);};}());var logOut=createAsyncThunk('auth/logout',/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_,_ref5){var rejectWithValue;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:rejectWithValue=_ref5.rejectWithValue;_context3.prev=1;_context3.next=4;return axios.post('/users/logout');case 4:token.unset();_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](1);return _context3.abrupt(\"return\",rejectWithValue());case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[1,7]]);}));return function(_x5,_x6){return _ref6.apply(this,arguments);};}());var fetchUser=createAsyncThunk('auth/fetchUser',/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_,_ref7){var getState,rejectWithValue,state,persistedToken,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:getState=_ref7.getState,rejectWithValue=_ref7.rejectWithValue;state=getState();persistedToken=state.auth.token;if(persistedToken){_context4.next=5;break;}return _context4.abrupt(\"return\",rejectWithValue());case 5:token.set(persistedToken);_context4.prev=6;_context4.next=9;return axios.get('/users/current');case 9:_yield$axios$get=_context4.sent;data=_yield$axios$get.data;return _context4.abrupt(\"return\",data);case 14:_context4.prev=14;_context4.t0=_context4[\"catch\"](6);return _context4.abrupt(\"return\",rejectWithValue());case 17:case\"end\":return _context4.stop();}}},_callee4,null,[[6,14]]);}));return function(_x7,_x8){return _ref8.apply(this,arguments);};}());export{register,logIn,logOut,fetchUser,token};","map":{"version":3,"names":["createAsyncThunk","axios","defaults","baseURL","token","set","headers","common","Authorization","unset","register","credentials","rejectWithValue","post","data","logIn","logOut","_","fetchUser","getState","state","persistedToken","auth","get"],"sources":["/Users/valentinkuzmich/Desktop/projects Go IT/goit-react-hw-08-phonebook/src/redux/auth/authOperations.js"],"sourcesContent":["import { createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios  from \"axios\";\n\naxios.defaults.baseURL = \"https://connections-api.herokuapp.com\";\n\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = ''\n  }\n};\n\nconst register = createAsyncThunk('auth/register', async (credentials,{rejectWithValue}) => {\n  try {\n    const { data } = await axios.post('/users/signup', credentials)\n    token.set(data.token)\n    return data\n  } catch (error) {\n    return rejectWithValue()\n  }\n})\n\nconst logIn = createAsyncThunk('auth/logIn', async (credentials,{rejectWithValue}) => {\n  try {\n    const { data } = await axios.post('/users/login', credentials)\n    token.set(data.token)\n    return data\n  } catch (error) {\n      return rejectWithValue()\n  }\n});\n\nconst logOut = createAsyncThunk('auth/logout', async (_,{rejectWithValue}) => {\n  try {\n    await axios.post('/users/logout')\n    token.unset()\n  } catch (error) {\n    return rejectWithValue()\n  }\n});\n\nconst fetchUser = createAsyncThunk('auth/fetchUser', async(_, { getState, rejectWithValue}) => {\n  const state = getState();\n  const persistedToken = state.auth.token;\n  if (!persistedToken) return rejectWithValue();\n\n  token.set(persistedToken)\n  \n  try {\n    const { data } = await axios.get('/users/current');\n    return data;\n  } catch (error) {\n    return rejectWithValue()\n  }\n});\n\nexport { register, logIn, logOut, fetchUser,token };\n"],"mappings":"4UAAA,OAASA,gBAAT,KAAiC,kBAAjC,CACA,MAAOC,MAAP,KAAmB,OAAnB,CAEAA,KAAK,CAACC,QAAN,CAAeC,OAAf,CAAyB,uCAAzB,CAEA,GAAMC,MAAK,CAAG,CACZC,GADY,cACRD,KADQ,CACD,CACTH,KAAK,CAACC,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,kBAAwDJ,KAAxD,EACD,CAHW,CAIZK,KAJY,iBAIJ,CACNR,KAAK,CAACC,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,CAA8C,EAA9C,CACD,CANW,CAAd,CASA,GAAME,SAAQ,CAAGV,gBAAgB,CAAC,eAAD,6FAAkB,iBAAOW,WAAP,oKAAoBC,eAApB,MAAoBA,eAApB,uCAExBX,MAAK,CAACY,IAAN,CAAW,eAAX,CAA4BF,WAA5B,CAFwB,wCAEvCG,IAFuC,mBAEvCA,IAFuC,CAG/CV,KAAK,CAACC,GAAN,CAAUS,IAAI,CAACV,KAAf,EAH+C,gCAIxCU,IAJwC,4FAMxCF,eAAe,EANyB,uEAAlB,oEAAjC,CAUA,GAAMG,MAAK,CAAGf,gBAAgB,CAAC,YAAD,6FAAe,kBAAOW,WAAP,0KAAoBC,eAApB,OAAoBA,eAApB,yCAElBX,MAAK,CAACY,IAAN,CAAW,cAAX,CAA2BF,WAA3B,CAFkB,0CAEjCG,IAFiC,oBAEjCA,IAFiC,CAGzCV,KAAK,CAACC,GAAN,CAAUS,IAAI,CAACV,KAAf,EAHyC,iCAIlCU,IAJkC,gGAMhCF,eAAe,EANiB,yEAAf,qEAA9B,CAUA,GAAMI,OAAM,CAAGhB,gBAAgB,CAAC,aAAD,6FAAgB,kBAAOiB,CAAP,kJAAUL,eAAV,OAAUA,eAAV,yCAErCX,MAAK,CAACY,IAAN,CAAW,eAAX,CAFqC,QAG3CT,KAAK,CAACK,KAAN,GAH2C,oHAKpCG,eAAe,EALqB,wEAAhB,qEAA/B,CASA,GAAMM,UAAS,CAAGlB,gBAAgB,CAAC,gBAAD,6FAAmB,kBAAMiB,CAAN,sMAAWE,QAAX,OAAWA,QAAX,CAAqBP,eAArB,OAAqBA,eAArB,CAC7CQ,KAD6C,CACrCD,QAAQ,EAD6B,CAE7CE,cAF6C,CAE5BD,KAAK,CAACE,IAAN,CAAWlB,KAFiB,IAG9CiB,cAH8C,2DAGvBT,eAAe,EAHQ,SAKnDR,KAAK,CAACC,GAAN,CAAUgB,cAAV,EALmD,wCAQ1BpB,MAAK,CAACsB,GAAN,CAAU,gBAAV,CAR0B,wCAQzCT,IARyC,kBAQzCA,IARyC,kCAS1CA,IAT0C,gGAW1CF,eAAe,EAX2B,yEAAnB,qEAAlC,CAeA,OAASF,QAAT,CAAmBK,KAAnB,CAA0BC,MAA1B,CAAkCE,SAAlC,CAA4Cd,KAA5C"},"metadata":{},"sourceType":"module"}